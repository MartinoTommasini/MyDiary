from pwn import *

r = remote("mercury.picoctf.net",2671)

# get n,e and c
r.recvuntil("n: ")
n = int(r.recvline().strip().decode())
r.recvuntil("e: ")
e = int(r.recvline().strip().decode())
r.recvuntil("ciphertext: ")
c = int(r.recvline().strip().decode())

print("n: ",n)
print("e: ",e)
print("c: ", c)


# generate new ciphertext
s = 2
c_forged = ( c * (s**e) ) % n

# send new ciphertext to the oracle and get response
r.recvuntil("Give me ciphertext to decrypt: ")
r.sendline(str(c_forged))

# receive decrypted message
r.recvuntil("Here you go: ")
m_forged = int(r.recvline().strip().decode())

# extract original message
s_inv = pow(s,-1,n)
m = (m_forged * s_inv) % n


print(bytearray.fromhex(hex(m)[2:]).decode())

r.close()
